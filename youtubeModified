int decrease = 0;
const int startFreq = 1;      //in Hz
const int maxFreq = 700;      //in Hz
int initialval = 1 /(2*double(startFreq)) * pow(10, 6);
int desiredval = 1 / (2*double(maxFreq)) * pow(10,6);
int delayTime;
double freq;
const byte DIR = 9;
const byte STEP = 10;
void setup() {
  pinMode(DIR, OUTPUT);
  pinMode(STEP, OUTPUT);
  digitalWrite(DIR, LOW);
  digitalWrite(STEP, LOW);
  Serial.begin(9600);
}
void delaySafe(unsigned long timeToDelay){
      if(timeToDelay < 16383)
        delayMicroseconds(timeToDelay);
      else 
        delay(timeToDelay*pow(10, -3));
}

void loop() {
  decrease = 0;
  while(decrease < initialval - desiredval){
    for(int i = 0; i < 5; i++){
      delayTime = initialval - decrease;
      freq = 1 /(2*pow(10,-6)*delayTime);
      Serial.println(freq);
      digitalWrite(STEP, HIGH);
      
      digitalWrite(STEP, LOW);
      if(delayTime < 16383)
        delayMicroseconds(delayTime);
      else delay(delayTime*pow(10, -3));
    }
    decrease++;
  }
  
  for(int i = 0; i <  5000; i++){
    freq = 1 /(2*pow(10,-6)*desiredval);
    Serial.println(freq);
    digitalWrite(STEP, HIGH);
    delayMicroseconds(desiredval);
    digitalWrite(STEP, LOW);
    delayMicroseconds(desiredval);  
  }

  decrease = 0;
  while(decrease < initialval - desiredval){
    for(int i = 0; i < 5; i++){
      freq = 1 /(2*pow(10,-6)*(initialval + decrease));
      Serial.println(freq);
      digitalWrite(STEP, HIGH);
      delayMicroseconds(initialval + decrease);
      digitalWrite(STEP, LOW);
      delayMicroseconds(initialval + decrease); 
    }
    decrease++;
  }
}
